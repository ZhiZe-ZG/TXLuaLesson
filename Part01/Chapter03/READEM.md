# Chapter 03 正名

接下来我们按照面向过程的思路介绍Lua语言。对于面向过程编程来说，有两个基本要素——变量和操作。

## 变量

“变量”的概念来源于数学上的“变量”。但是在实际上编程中一般所说的“变量”和数学中不同分支学科中的“变量”不完全一致。

> 纯函数式编程中理论上是“无变量”的。但是那些作为占位符的名称在数学上其实也是变量。

根据变量机制的实际实现方式，我们经常把“变量”类比为一些仓库。我们可以在其中存放一种名为“值”的东西，也可以在需要时从变量中复制所存储的值，或者用新的值覆盖原先保存的值。直观来说，整数，有理数，实数，列表这些东西都是值，而变量是用来保存这些值的东西。

> 之所要强调保存值，是因为面向过程编程中是讲“时序”的。任何不刻意保存的东西，都有可能随着时间的流逝而消失。

### 变量名

为了区别不同的仓库，我们可以给不同的仓库编号，命名。为了区别不同的变量，我们也可以给不同的变量编号命名。在Lua中，变量名必须是按照这样的规则生成的：

1. 以大小写字母或者下划线开头。
1. 由大小写字母，下划线或数字组成。
1. 不能与关键字重复。

附上一个Lua的关键字列表：

| 关键字 | 关键字 | 关键字   | 关键字 | 关键字 | 关键字 |
| ------ | ------ | -------- | ------ | ------ | ------ |
| and    | break  | do       | else   | elseif | end    |
| false  | for    | function | goto   | if     | in     |
| local  | nil    | not      | or     | repeat | return |
| then   | true   | until    | while  |        |        |

关键字不能作为变量名是因为这些关键字在Lua已经被赋予了其他用途。

> 在Lua变量命名中同一个字母的大写和小写算不同的字符，所以“And”和“and”是不同的。因此“And”可以作为变量名。

按照以上生成规则，理论上可以生成无限个变量名。因此如果你不考虑内存占用问题的话，理论上Lua中可以有无限个变量。

> 即便不是无限个变量名，限制变量名只能由20个字符组成，那我们也有$\sum ^{n=19}_{i=0}{(26+26+1)*(26+26+1+10)^i}-22$个可用的变量名。

不过需要注意的是，以上规则生成的仅仅是符合语法规则的变量名。除了语法规则我们还要遵守一些其他规则：

1. 有一些特殊变量名也有预先约定好的用途。这些特殊变量名我们后续会有所介绍。一般来说，这些特殊变量名不应当被用作其他用途。
1. 变量名应当尽量表达清楚它的作用。所以“wa_wkjic000xgo238hmone_cg”这种不明所以的变量名是不推荐使用的。不过在写一些简短的表达式的时候我们还是可以使用“y”，“x”，“i”，“pi”这类比较简短的变量名的。

### 读取和赋值

变量是仓库，所以最基本的操作就是读写变量。在Lua中所有出现变量名的地方，都认为是在读取变量中所存储的值——除非变量名出现在`=`左侧。

关于读取的例子：

```lua
-- 输出变量a中所存储的内容，而非输出字母“a”。
print(a)
-- 其实单独写一个变量名也表示读这个变量，但是读取后不做任何事。
-- 所以在脚本中一行单写一个变量名一般没有意义。
a
```

> 所有变量的默认值都是`nil`。因此访问一个从未被赋值过的变量，得到的就是`nil`。

关于赋值的例子：

```lua
-- 将数字12赋值给变量a。
a = 12
-- 将变量a的值赋予变量b。这里读取a变量，赋值给b变量。
b = a
-- 同时给多个变量赋值，按照顺序匹配。
-- 左边的第一个变量被赋予右边第一个表达式的值。
-- 剩下的变量和表达式继续依次匹配。
-- 多出来的值不会被使用。多出来的变量会被赋予`nil`值。
a,b,c = 'hello','goodbye','see you'
```

需要注意，读取变量不会改变变量的内容。但是赋值给变量的时候会改变变量的内容。

> 在Lua虚拟机中我们实际上没法真正“删除”一个变量。因为一个变量名始终是可用的。你读取任何变量名都不会报错。因此，我们给一个变量赋值`nil`，恢复它的初始状态，就相当于删除了这个变量。
>
> 仅仅从Lua虚拟机内部来看，赋值nil给变量这个动作往往可有可无。但是考虑到虚拟机本身的内存占用，我们有时候还是要主动删除一些已经用不着的变量来释放内存空间。

## 值

说到了变量就一定要说一下值。什么是“值”这个话题可以聊很久。不过我觉得面向过程编程的入门教程不应该在这么沉重的话题上绕圈子。所以我们简单处理一下。值就是用来往变量里存的东西。顺便值之间还能进行运算。所谓的运算就是用一两个值算一算得到一个值。Lua中有且只有以下8个值类别。

- nil 空值

- boolean 逻辑值

- number 数字

- string 字符串

- function 函数

- userdata 用户数据

- thread 线程

- table 表

以上所述的8个值类型中，每个类别内都包含至少一个值。这8个类别加起来就涵盖了Lua中所有的值。我们后边再针对每个类别详细介绍。

### 字面值

对于值来说，我们有时候也需要通过值的名字直接表示值。为了这个用途给值起的名字就是字面值。

比如表示空值的`nil`，表示逻辑值的`true`和`false`，表示数字的`1`，`2`，`32`等，表示字符串的各种用引号括起来的字符串（字符串的内容加上包括它的引号合起来算是字面值，但是这个字面值表示的值中没有两侧的引号）。

## 操作

“操作”就可以按照字面意思理解。任何以变量为对象的动作都可以称之为“操作”。比如把一个值存入某个变量是一个操作，把一个变量的值复制给另一个变量也是操作。这两种是非常简单的操作。编程中还会用到更复杂的操作。比如把A，B两个变量的值相加然后赋值给B（我们把送值进入变量的操作称为“赋值”）。

> 面向过程编程的时序性对于操作同样有影响。同样的操作集合按照不同的顺序排列就可能导致不同的结果。

有了名词和动词，我们就能组织出语句。在编程中，有了变量和操作，我们就能组织出程序。







可变类型的区别在于内存空间

### 变量作用域

放到介绍语句的时候介绍

```lua
for i=1,10 do for i=2,20 do print(i) end end
```



动作，赋值，和计算

### 自动空值，变量初始化







### 字面值

一些特殊的字符组合是专门用来表示值而非变量名的。



可变值和不可变值（引用传递和值传递）

字面值

## 值

当我不需要解释什么是“值”的时候，我知道什么是值。但是要我就是什么是“值”的时候我发现我不知道什么是“值”。不是说我真的不“知道”什么是“值”，而是我发现很难向不知道的人说清楚。因为“值”这个概念相当底层。就像学数学时候，向别人解释什么是“数”是非常困难的。

尽管如此，我还是打算尝试解释一下什么是值。

### 因区别而存在

数字1，2，3和字符‘a’，‘b’，‘c’都是值。为了后边叙述方便，我们会用到“一个值”，“一类值”这种看起来有点别扭的说法。

首先，“值”们是可以相互区别的。例如：值2是不等于值1的；值‘a’是不等于值‘b’的；值3也是不等于值‘c’的。

> 根本不存在两个完全一样，没有任何区别的值。因为，如果它们完全一样，对人来说它们就是同一个值，根本没有“两个”。一般说的“两个值相等”其实是在说“两个变量存储的值相等”（一个值等于它自身）或者说“两个变量存储的值是同一个值”。
>
> 如果理解不了这点，可以考虑这样一个问题。两个球体在各种物理属性上完全一致，甚至空间位置都是重合的。让你去观察，你能看出这是“两个”球体么？如果在各种物理实验之下，它们的表现都完全一致，那么把它们当作“两个”有什么意义呢？

其次，“值”之间是存在关系的，是可以运算的。例如：值2小于值3；值1加值2等于值3。

最后，一个“值”本身代表什么并不重要。我们想让它代表什么它就能代表什么。（只不过，我们应当尽量让值之间的关系能够体现“值”们所代表的东西们之间的关系。)

> 顺便一提，值的写法也不是最重要的。$1+2=3$，$1+10=11$，$A+B=C$，$\square + \triangle = \bigcirc$这三个式子其实可以表示同一个关系。

所以，对于一个值来说，我们只要知道它存在就可以。

当已经有一堆值的时候，我们要声明一个新的值，就要保证这个值和已经存在的任何一个值都是不同的。

实际使用中，我们往往还需要定义这个值和已经存在的值之间的关系。

### 赋予名称

我们可以知道一个值存在，还可以知道它不同于其他值，还可以知道它和其他值之间有这样那样的关系。但是我们就是不知道它叫什么。因为值原本就是没有名字的（匿名的）。

### 值的类别

如果两个值相等，那么它们本质上就是同一个值。实际上就不存在两个值，而仅仅有一个值。因而





## 常量





