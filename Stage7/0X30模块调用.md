# 0X30 模块调用

## 前置知识

* 0X2A 支持UTF8
* 0X2F 函数和表

## 正文

### 1. 代码复用

假设针对一个数学问题你提出了一套解答方法,并且用程序将其实现.下次遇到同类或类似问题,你就只需要拷贝你原来的代码来解决问题.像这样重复使用代码解决同类或者相似的问题,就称为代码复用.

为了使得代码复用更加安全,语法上更加简洁.在代码复用时我们一般不直接复制同样的代码,而是采用一些更为迂回的方式.将重复用率非常高的代码组织成一个代码库,从代码库中调用需要的代码就是其中的一种重要的方式.

例如,利用泰勒展开式求sin函数的近似值是一个确定的公式.我们可以将其打包为一个函数,然后再把它和其他很多数学计算上用到的函数打包成一个代码库.需要用时就加载这个代码库然后调用这些函数.

### 2. 库代码的组织

虽然Lua中可以把各种变量值打包到代码库中去.但是一般来说,最基本的单位是函数.(有时候为了配合函数的使用,会把一些使用频率非常高的常数直接打包进去.但是把这些常数打包成一些把它们作为返回值的函数也未尝不可.)

在面向对象语言中,即使有一些非函数类型的数据需要打包,也常常把它们隐藏起来,通过一些函数去读写.这就是所谓的属性.

总而言之,我们以函数作为库代码中最基本的单位.一个库由若干函数组成.

在Lua中一个库就是若干函数组成的一张表.这张表又称为模块.加载模块的过程,就是根据定义这张表的Lua代码生成这张表,并把它引入需要使用它的虚拟机环境中.

### 3. 模块引用

需要在当前的代码环境中引用某个模块的时候,就使用require函数加载这个模块.

require函数接受一个字符串作为参数,返回一个表.这个传入字符串就是模块的名称.返回的表就是模块.

Lua提供的标准库中除了print,require等少数可以直接使用的函数以外.大部分是以模块的形式提供的.之前的很多教程中提到的require函数的调用就是为了加载相应的模块.例如:

>```lua
>require('math')
>```

请注意,如果require的返回值没有任何变量接收.require会自动把和模块同名的变量赋值为模块本身.所以为了安全起见,最好在调用模块时显示说明把模块这个表赋予哪个变量.这个变量的名称可以和模块本身的名称不一致,例如:

>```lua
>str=require('string')
>```

## 后续推荐

* 0X31 模块编写
