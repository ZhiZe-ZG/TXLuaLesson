# 0X37搜寻字符串

## 前置知识

* 0X32模块搜寻

## 正文

### 问题的提出

在模块搜寻中,我们说到lua会在目录下搜索文件名,找到和需要导入的模块名称匹配的.如果你需要自己实现一个类似的功能,像没有用任何字符串处理库的C语言那样逐个字符比较固然可以.但是更高效的做法是使用字符串模式匹配技术.在这节我们要介绍正则表达式就是一种此类技术的实现.

### 简单的查找

先看一个简单的例子,我们搜索字符串,查看它是否含有指定字符串.一般来说如果一个文件名中含有某个关键词,我们就会认为这个文件名可能和关键词关联的主题有关系.

>```lua
>str='abcaoeudndogahoeantga'
>p='dog'
>string.find(str,p)
>```

这里的str是被检查的字符串.p是我们希望在str中找到的东西,称为模式(pattern).这里我们直接以字符串'dog'作为模式,所以就会在str中搜寻有没有'dog'.

string.find函数的作用就是在str中搜寻p.如果找到就返回第一个匹配的位置(两个返回值,匹配到的位置的开头和结尾,都以数字形式返回,默认第一个字符是1号.)如果没有找到就返回一个nil.

有时候我们希望不要从str的开头开始查找,就可以给string.find第三个参数.它会指定搜索开始的位置.

>```lua
>str='abcdogabcdog'
>p='dog'
>i=5
>string.find(str,p,i)
>```

字符串str中有两个子串'dog',但是由于从第5个字符开始匹配,这里会匹配到第二个子串'dog'.如果这个参数是负数,表示从倒数第几个字符开始匹配.

### 位置锚定

有时候我们需要强制从字符串开头进行匹配以排除一些错误匹配(例如要匹配以字母a开头的字符串).有时候也需要强制对齐匹配字符串到尾部(比如匹配文件后缀名).这时候就要用到位置锚定.

如果模式以`'^'`开头,则表示必须从字符串开头匹配.例如:

>```lua
>string.find('bac','^ac')
>string.find('bac','ac')
>```

如果模式以`'$'`结尾则表示必须对齐结尾.例如:

>```lua
>string.find('abab','ab$')
>string.find('abab','ab')
>```

## 后续推荐

* 0X38字符类